{"version":3,"sources":["Carousel.js"],"names":["window","document","Carousel","options","this","el","HTMLElement","querySelector","imgs","push","unshift","length","autoPlay","timer","time","index","imgNodes","_init","prototype","console","log","style","overflow","fragement","createDocumentFragment","width","clientWidth","content","createElement","height","transform","id","appendChild","_eventBind","i","img","display","src","_autoPlay","_onResize","_slide","that","WebkitTransition","transition","setTimeout","flag","getAngle","x","y","Math","atan2","PI","getDirection","startx","starty","endx","endy","abs","angle","direction","startTime","endTime","isTouchMove","addEventListener","event","preventDefault","clearInterval","touches","pageX","pageY","Date","getTime","changedTouches","setInterval","forEach","item"],"mappings":"CAAA,SAAWA,EAAQC,GACjB,SAASC,EAASC,GAChB,KAAMC,gBAAgBF,GACpB,OAAO,IAAIA,EAASC,GAEpBC,KAAKC,GAAMF,EAAQE,IAAOF,EAAQE,cAAcC,YAC9CH,EAAQE,GACRJ,EAASM,cAAcJ,EAAQE,IACjCD,KAAKI,KAAOL,EAAQK,KACpBJ,KAAKI,KAAKC,KAAKL,KAAKI,KAAK,IACzBJ,KAAKI,KAAKE,QAAQN,KAAKI,KAAKL,EAAQK,KAAKG,OAAS,IAClDP,KAAKQ,SAAWT,EAAQS,WAAY,EACpCR,KAAKS,MAAQ,KACbT,KAAKU,KAAOX,EAAQW,MAAQ,IAC5BV,KAAKW,MAAQ,EACbX,KAAKY,YACLZ,KAAKa,QAGTf,EAASgB,WACPD,MAAO,WACLE,QAAQC,IAAIhB,KAAKC,IACjBD,KAAKC,GAAGgB,MAAMC,SAAW,SACzB,IAAIC,EAAYtB,EAASuB,yBACzBpB,KAAKqB,MAAQrB,KAAKC,GAAGqB,YACrBP,QAAQC,IAAIhB,KAAKqB,OACjB,IAAIE,EAAU1B,EAAS2B,cAAc,OACrCD,EAAQN,MAAMI,MAAQrB,KAAKqB,MAAQrB,KAAKI,KAAKG,OAAS,KACtDgB,EAAQN,MAAMQ,OAAS,OACvBF,EAAQN,MAAMS,UAAY,cAAgB1B,KAAKqB,MAAQ,SACvDE,EAAQI,GAAK,mBACbR,EAAUS,YAAYL,GACtBvB,KAAKuB,QAAUA,EACfvB,KAAK6B,WAAWN,GAChB,IAAK,IAAIO,EAAI,EAAGA,EAAI9B,KAAKI,KAAKG,OAAQuB,IAAK,CACzC,IAAIC,EAAMlC,EAAS2B,cAAc,OACjCO,EAAId,MAAMQ,OAAS,OACnBM,EAAId,MAAMe,QAAU,eACpBD,EAAId,MAAMI,MAAQrB,KAAKqB,MAAQ,KAC/BU,EAAIE,IAAMjC,KAAKI,KAAK0B,GACpB9B,KAAKY,SAASP,KAAK0B,GACnBR,EAAQK,YAAYG,GAEtB/B,KAAKC,GAAG2B,YAAYT,GAChBnB,KAAKQ,UACPR,KAAKkC,YAEPlC,KAAKmC,aAEPC,OAAQ,SAAUzB,GAChB,IAAI0B,EAAOrC,KACXqC,EAAK1B,MAAQA,EACb0B,EAAKd,QAAQN,MAAMqB,iBAAmB,OAASD,EAAK3B,KAAO,KAC3D2B,EAAKd,QAAQN,MAAMsB,WAAa,OAASF,EAAK3B,KAAO,KACrD2B,EAAKd,QAAQN,MAAMS,UAAY,cAAgBW,EAAKhB,MAAQgB,EAAK1B,MAAQ,SACzE6B,WAAW,WACTH,EAAKd,QAAQN,MAAMqB,iBAAmB,UACtCD,EAAKd,QAAQN,MAAMsB,WAAa,WAC/BF,EAAK3B,MACR,IAAI+B,GAAO,EAEO,GAAdJ,EAAK1B,OACP0B,EAAK1B,MAAQ0B,EAAKjC,KAAKG,OAAS,EAChCkC,GAAO,GACEJ,EAAK1B,OAAS0B,EAAKjC,KAAKG,OAAS,IAC1C8B,EAAK1B,MAAQ,EACb8B,GAAO,GAELA,GACFD,WAAW,WACTH,EAAKd,QAAQN,MAAMS,UAAY,cAAgBW,EAAKhB,MAAQgB,EAAK1B,MAAQ,UACxE0B,EAAK3B,OAGZmB,WAAY,SAAUN,GAqDpB,SAASmB,EAAUC,EAAGC,GACpB,OAA0B,IAAnBC,KAAKC,MAAMF,EAAGD,GAAWE,KAAKE,GAEvC,SAASC,EAAcC,EAAQC,EAAQC,EAAMC,GAC3C,IAAIT,EAAIQ,EAAOF,EACXL,EAAIQ,EAAOF,EACf,KAAIL,KAAKQ,IAAIV,GAAK,GAAKE,KAAKQ,IAAIT,GAAK,GAArC,CAGA,IAAIU,EAAQZ,EAASC,EAAGC,GACxB,OAAIU,IAAU,IAAMA,EAAQ,GACnB,EACEA,GAAS,IAAMA,EAAQ,IACzB,EACGA,GAAS,KAAOA,EAAQ,KAASA,IAAW,KAAOA,GAAS,IAC/D,EACEA,IAAU,KAAOA,GAAS,GAC5B,OADF,GApET,IAAIL,EAAQC,EAAQC,EAAMC,EAEtBG,EACAC,EAAWC,EAFXpB,EAAOrC,KAGP0D,GAAc,EAClBnC,EAAQoC,iBAAiB,aAAc,SAAUC,GAC/CA,EAAMC,iBACFxB,EAAK7B,UACPsD,cAAczB,EAAK5B,OAErBwC,EAASW,EAAMG,QAAQ,GAAGC,MAC1Bd,EAASU,EAAMG,QAAQ,GAAGE,MAC1BT,GAAY,IAAIU,MAAOC,YACtB,GACH5C,EAAQoC,iBAAiB,YAAa,SAAUC,GACX,IAA/BA,EAAMQ,eAAe7D,QAA0B,IAAX0C,GAA2B,IAAXC,IAGxDC,EAAOS,EAAMQ,eAAe,GAAGJ,MAC/BZ,EAAOQ,EAAMQ,eAAe,GAAGH,MAC/B1C,EAAQN,MAAMS,UAAY,eAAiBW,EAAKhB,MAAQgB,EAAK1B,MAAQwC,EAAOF,GAAU,SACtFQ,GAAU,IAAIS,MAAOC,UACrBT,GAAc,KACb,GACHnC,EAAQoC,iBAAiB,WAAY,SAAUC,GAC7C,IAAKf,KAAKQ,IAAIF,EAAOF,GAAUZ,EAAKhB,MAAQ,GACxCwB,KAAKQ,KAAKF,EAAOF,IAAWQ,EAAUD,IAAc,KAAQE,EAChE,CAEE,OADAH,EAAYP,EAAaC,EAAQC,EAAQC,EAAMC,IAE7C,KAAK,EACHf,EAAKD,OAAOC,EAAK1B,MAAQ,GACzB,MACF,KAAK,EACH0B,EAAKD,OAAOC,EAAK1B,MAAQ,GAG7B+C,GAAc,OAEdrB,EAAKd,QAAQN,MAAMqB,iBAAmB,OAASD,EAAK3B,KAAO,KAC3D2B,EAAKd,QAAQN,MAAMsB,WAAa,OAASF,EAAK3B,KAAO,KACrDa,EAAQN,MAAMS,UAAY,cAAgBW,EAAKhB,MAAQgB,EAAK1B,MAAQ,SACpE6B,WAAW,WACTH,EAAKd,QAAQN,MAAMqB,iBAAmB,UACtCD,EAAKd,QAAQN,MAAMsB,WAAa,WAC/BF,EAAK3B,MAEN2B,EAAK7B,UACP6B,EAAKH,cAEN,IAuBLA,UAAW,WACT,IAAIG,EAAOrC,KACXqC,EAAK5B,MAAQ4D,YAAY,WACvBhC,EAAKD,OAAOC,EAAK1B,MAAQ,IACxB0B,EAAK7B,WAEV2B,UAAW,WACT,IAAIE,EAAOrC,KACXJ,EAAO+D,iBAAiB,SAAU,WAChCtB,EAAKhB,MAAQgB,EAAKpC,GAAGqB,YACrBP,QAAQC,IAAIqB,EAAKhB,OACjBgB,EAAKd,QAAQN,MAAMI,MAAQgB,EAAKhB,MAAQgB,EAAKjC,KAAKG,OAAS,KAC3D8B,EAAKzB,SAAS0D,QAAQ,SAAUC,GAC9BA,EAAKtD,MAAMI,MAAQgB,EAAKhB,MAAQ,OAElCgB,EAAKD,OAAOC,EAAK1B,SAChB,KAGPf,EAAOE,SAAWA,EAvKpB,CAwKGF,OAAQC","file":"Carousel.js","sourcesContent":["(function (window, document) {\r\n  function Carousel(options) {\r\n    if (!(this instanceof Carousel)) {\r\n      return new Carousel(options);\r\n    } else {\r\n      this.el = (options.el && (options.el instanceof HTMLElement)) ? \r\n        options.el :\r\n        document.querySelector(options.el);\r\n      this.imgs = options.imgs;\r\n      this.imgs.push(this.imgs[0]);\r\n      this.imgs.unshift(this.imgs[options.imgs.length - 2]);\r\n      this.autoPlay = options.autoPlay || false;\r\n      this.timer = null;\r\n      this.time = options.time || 300;\r\n      this.index = 1;\r\n      this.imgNodes = [];\r\n      this._init();\r\n    }\r\n  }\r\n  Carousel.prototype = {\r\n    _init: function () {\r\n      console.log(this.el)\r\n      this.el.style.overflow = 'hidden';\r\n      var fragement = document.createDocumentFragment();\r\n      this.width = this.el.clientWidth;\r\n      console.log(this.width);\r\n      var content = document.createElement('div');\r\n      content.style.width = this.width * this.imgs.length + 'px';\r\n      content.style.height = '100%';\r\n      content.style.transform = 'translate(-' + this.width + 'px, 0)';\r\n      content.id = 'carousel-content';\r\n      fragement.appendChild(content);\r\n      this.content = content;\r\n      this._eventBind(content);\r\n      for (var i = 0; i < this.imgs.length; i++) {\r\n        var img = document.createElement('img');\r\n        img.style.height = '100%';\r\n        img.style.display = 'inline-block';\r\n        img.style.width = this.width + 'px';\r\n        img.src = this.imgs[i];\r\n        this.imgNodes.push(img);\r\n        content.appendChild(img);\r\n      }\r\n      this.el.appendChild(fragement);\r\n      if (this.autoPlay) {\r\n        this._autoPlay();\r\n      }\r\n      this._onResize();\r\n    },\r\n    _slide: function (index) {\r\n      var that = this;\r\n      that.index = index;\r\n      that.content.style.WebkitTransition = 'all ' + that.time + 'ms';\r\n      that.content.style.transition = 'all ' + that.time + 'ms';\r\n      that.content.style.transform = 'translate(-' + that.width * that.index + 'px, 0)';\r\n      setTimeout(function () {\r\n        that.content.style.WebkitTransition = 'all 0ms';\r\n        that.content.style.transition = 'all 0ms';\r\n      }, that.time);\r\n      var flag = false;\r\n\r\n      if (that.index == 0) {\r\n        that.index = that.imgs.length - 2;\r\n        flag = true;\r\n      } else if (that.index == that.imgs.length - 1) {\r\n        that.index = 1;\r\n        flag = true;\r\n      }\r\n      if (flag) {\r\n        setTimeout(function () {\r\n          that.content.style.transform = 'translate(-' + that.width * that.index + 'px, 0)';\r\n        }, that.time);\r\n      }\r\n    },\r\n    _eventBind: function (content) {\r\n      var startx, starty, endx, endy;\r\n      var that = this;\r\n      var direction;\r\n      var startTime, endTime;\r\n      var isTouchMove = false;\r\n      content.addEventListener('touchstart', function (event) {\r\n        event.preventDefault();\r\n        if (that.autoPlay) {\r\n          clearInterval(that.timer);\r\n        }\r\n        startx = event.touches[0].pageX;\r\n        starty = event.touches[0].pageY;\r\n        startTime = new Date().getTime();\r\n      }, false);\r\n      content.addEventListener('touchmove', function (event) {\r\n        if (event.changedTouches.length !==1 || startx === 0 || starty === 0) {\r\n          return;\r\n        }\r\n        endx = event.changedTouches[0].pageX;\r\n        endy = event.changedTouches[0].pageY;\r\n        content.style.transform = 'translate(' + (-that.width * that.index + endx - startx) + 'px, 0)';\r\n        endTime = new Date().getTime();\r\n        isTouchMove = true;\r\n      }, false);\r\n      content.addEventListener('touchend', function (event) {\r\n        if ((Math.abs(endx - startx) > that.width / 2 || \r\n            Math.abs((endx - startx) / (endTime - startTime)) > 0.7) && isTouchMove)\r\n        {\r\n          direction = getDirection(startx, starty, endx, endy);\r\n          switch (direction) {\r\n            case 1:\r\n              that._slide(that.index - 1);\r\n              break;\r\n            case 3:\r\n              that._slide(that.index + 1);\r\n              break;\r\n          }\r\n          isTouchMove = false;\r\n        } else {\r\n          that.content.style.WebkitTransition = 'all ' + that.time + 'ms';\r\n          that.content.style.transition = 'all ' + that.time + 'ms';\r\n          content.style.transform = 'translate(-' + that.width * that.index + 'px, 0)';\r\n          setTimeout(function () {\r\n            that.content.style.WebkitTransition = 'all 0ms';\r\n            that.content.style.transition = 'all 0ms';\r\n          }, that.time);\r\n        }\r\n        if (that.autoPlay) {\r\n          that._autoPlay();\r\n        }\r\n      }, false);\r\n      \r\n      function getAngle (x, y) {\r\n        return Math.atan2(y, x) * 180 / Math.PI;\r\n      }\r\n      function getDirection (startx, starty, endx, endy) {\r\n        var x = endx - startx;\r\n        var y = endy - starty;\r\n        if (Math.abs(x) < 2 && Math.abs(y) < 2) {\r\n          return;\r\n        }\r\n        var angle = getAngle(x, y);\r\n        if (angle >= -45 && angle < 45) {\r\n          return 1;\r\n        } else if (angle >= 45 && angle < 135) {\r\n          return 2;\r\n        } else if ((angle >= 135 && angle < 180) || (angle >= - 180 && angle < -135)) {\r\n          return 3;\r\n        } else if (angle >= -135 && angle < -45) {\r\n          return 4;\r\n        }\r\n      }\r\n    },\r\n    _autoPlay: function () {\r\n      var that = this;\r\n      that.timer = setInterval(function () {\r\n        that._slide(that.index + 1);\r\n      }, that.autoPlay);\r\n    },\r\n    _onResize: function () {\r\n      var that = this;\r\n      window.addEventListener('resize', function () {\r\n        that.width = that.el.clientWidth;\r\n        console.log(that.width);\r\n        that.content.style.width = that.width * that.imgs.length + 'px';\r\n        that.imgNodes.forEach(function (item) {\r\n          item.style.width = that.width + 'px';\r\n        });\r\n        that._slide(that.index);\r\n      }, false);\r\n    }\r\n  }\r\n  window.Carousel = Carousel;\r\n})(window, document);"]}